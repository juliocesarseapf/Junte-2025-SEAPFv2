<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Invocación - El Junte Definitivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- MEJORA: Se añadió la tipografía 'Nosifier' y 'Butcherman' para un impacto más terrorífico -->
    <link href="https://fonts.googleapis.com/css2?family=Butcherman&family=Creepster&family=Montserrat:wght@400;700;900&family=Metal+Mania&family=Teko:wght@500&family=Nosifier&display=swap" rel="stylesheet">
    <style>
        :root {
            --blood-red: #ff0000;
            --toxic-green: #00ff7f;
            --dark-abyss: #000000;
            --ghostly-white: #f0f0f0;
            --demonic-purple: #6f00ff;
        }

        /* --- KEYFRAME ANIMATIONS --- */
        @keyframes spectral-glow { 0%, 100% { text-shadow: 0 0 10px var(--blood-red), 0 0 20px var(--blood-red), 0 0 40px #ff0000, 0 0 5px #fff; transform: scale(1); } 50% { text-shadow: 0 0 20px var(--toxic-green), 0 0 40px var(--toxic-green), 0 0 80px #00ff7f, 0 0 10px #fff; transform: scale(1.02); } }
        @keyframes lightning-flash { 0%, 100% { opacity: 0; } 5%, 50% { opacity: 0.8; } 6%, 51% { opacity: 0.1; } }
        @keyframes text-flicker { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
        @keyframes ghost-letter { from { opacity: 0; transform: translateY(20px) scale(1.2); filter: blur(5px); } to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); } }
        @keyframes button-glow-pulse { 0%, 100% { text-shadow: 0 0 10px var(--blood-red); box-shadow: 0 0 20px var(--blood-red); } 50% { text-shadow: 0 0 20px var(--ghostly-white); box-shadow: 0 0 35px var(--blood-red); } }
        @keyframes vhs-static-flicker { 0% { opacity: 0.08; } 20% { opacity: 0.15; } 40% { opacity: 0.1; } 60% { opacity: 0.18; } 80% { opacity: 0.09; } 100% { opacity: 0.08; } }
        @keyframes hell-is-open { 0% { letter-spacing: -1em; opacity: 0; filter: blur(10px); } 40% { filter: blur(2px); } 100% { letter-spacing: 0.1em; opacity: 1; filter: blur(0); } }
        @keyframes epic-title-intro { 0% { opacity: 0; transform: scale(2.5) rotate(-5deg); filter: blur(12px); text-shadow: 0 0 50px #ff0000; } 60% { opacity: 1; transform: scale(0.9) rotate(5deg); filter: blur(1px); text-shadow: 0 0 30px #ff0000, 0 0 60px #fff; } 100% { opacity: 1; transform: scale(1) rotate(0deg); filter: blur(0); } }
        
        /* --- NUEVA ANIMACIÓN --- */
        @keyframes highlight-pulse {
            0%, 100% {
                transform: scale(1);
                text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px var(--demonic-purple), 0 0 20px var(--demonic-purple);
            }
            50% {
                transform: scale(1.1);
                text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px var(--demonic-purple), 0 0 40px var(--demonic-purple);
            }
        }

        /* --- BASE STYLES --- */
        body { font-family: 'Montserrat', sans-serif; background-color: var(--dark-abyss); color: var(--ghostly-white); overflow-x: hidden; cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 256 256"><g transform="rotate(180 128 128)"><path fill="%23ff0000" stroke="%23ffffff" stroke-width="8" d="M168 96a40 40 0 0 0-80 0c0 32.5 40 96 40 96s40-63.5 40-96Z"/></g></svg>') 16 31, auto; }

        /* --- BACKGROUND & OVERLAYS --- */
        #video-bg { position: fixed; right: 0; bottom: 0; min-width: 100%; min-height: 100%; z-index: -2; object-fit: cover; filter: grayscale(80%) brightness(0.4); transform: scale(1.1); transition: filter 1s ease-in-out; }
        .vhs-overlay::after { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url(https://www.transparenttextures.com/patterns/subtle-noise.png); opacity: 0.1; z-index: -1; pointer-events: none; animation: vhs-static-flicker 0.15s infinite; }
        #lightning { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 9997; opacity: 0; pointer-events: none; }
        .scroll-watcher { height: 10px; position: fixed; top: 0; z-index: 1000; background-color: var(--blood-red); width: 100%; scale: 0 1; transform-origin: left; animation: scroll-watcher linear; animation-timeline: scroll(); }

        /* --- TYPOGRAPHY & UI --- */
        .creepster { font-family: 'Creepster', cursive; color: var(--blood-red); animation: spectral-glow 4s infinite ease-in-out; letter-spacing: 0.1em; text-transform: uppercase; word-break: break-word; }
        .metal-mania { font-family: 'Metal Mania', cursive; text-shadow: 0 0 4px rgba(255, 255, 255, 0.4); letter-spacing: .05em; }
        /* MEJORA: Se añade la clase para la nueva fuente */
        .nosifier { font-family: 'Nosifier', cursive; text-shadow: 0 0 10px var(--toxic-green), 0 0 20px var(--toxic-green); }
        .butcherman { font-family: 'Butcherman', cursive; color: var(--blood-red); animation: spectral-glow 4s infinite ease-in-out; text-transform: uppercase; word-break: break-word; }
        .cta-button { background-color: var(--blood-red); color: var(--dark-abyss); font-weight: 900; transition: all 0.3s; border: 2px solid var(--blood-red); clip-path: polygon(0 0, 100% 0, 100% 100%, 8% 100%, 0 75%); }
        .cta-button:hover { background-color: transparent; color: var(--blood-red); transform: scale(1.05); }
        .ghost-reveal-text span { display: inline-block; opacity: 0; animation: ghost-letter 0.5s ease-out forwards; }
        .highlight-version {
            animation: highlight-pulse 2s infinite ease-in-out;
            display: inline-block;
            padding: 0.2rem 0.5rem;
        }
        
        /* --- COUNTDOWN TIMER --- */
        #countdown-container { perspective: 800px; }
        .time-block { display: flex; flex-direction: column; align-items: center; }
        .flip-card { display: inline-flex; flex-direction: column; position: relative; width: clamp(40px, 12vw, 80px); height: clamp(60px, 18vw, 120px); }
        .flip-card-inner { position: absolute; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; justify-content: center; align-items: center; font-family: 'Teko', sans-serif; font-size: clamp(3rem, 15vw, 7rem); color: var(--ghostly-white); background: #1a1a1a; border-radius: 8px; }
        .flip-card-back { background: #2a2a2a; transform: rotateX(180deg); }
        .time-label { font-family: 'Creepster', cursive; font-size: clamp(0.8rem, 3vw, 1.2rem); margin-top: 10px; color: var(--toxic-green); }
        .separator { font-family: 'Teko', sans-serif; font-size: clamp(3rem, 15vw, 7rem); color: var(--blood-red); animation: text-flicker 1.5s infinite; }
        #countdown-ended-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.95); z-index: 9999; display: flex; justify-content: center; align-items: center; text-align: center; opacity: 0; pointer-events: none; transition: opacity 1s ease-in-out; }
        #countdown-ended-overlay.active { opacity: 1; pointer-events: auto; }
        .end-message { font-family: 'Creepster', cursive; color: var(--blood-red); font-size: clamp(2rem, 8vw, 6rem); text-shadow: 0 0 20px var(--blood-red); animation: hell-is-open 2s ease-in-out forwards; }
        
        /* --- MODAL SEQUENCE --- */
        #modal-sequence { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 10000; display: flex; align-items: center; justify-content: center; text-align: center; }
        .modal-step { display: none; flex-direction: column; align-items: center; justify-content: center; padding: 2rem; }
        .modal-step.active { display: flex; }
        .modal-text { font-family: 'Creepster', cursive; font-size: clamp(2rem, 8vw, 5rem); color: var(--blood-red); text-shadow: 0 0 10px var(--blood-red); animation: text-flicker 3s infinite; }
        .modal-button { background: transparent; border: 2px solid var(--blood-red); color: var(--blood-red); padding: 15px 35px; font-family: 'Montserrat', sans-serif; font-weight: 900; font-size: 1.2rem; cursor: inherit; margin-top: 2rem; transition: all 0.3s ease-in-out; clip-path: polygon(10% 0, 100% 0, 95% 100%, 0 100%); animation: button-glow-pulse 2s infinite ease-in-out; position: relative; }
        .modal-button:hover { background: var(--blood-red); color: var(--dark-abyss); transform: scale(1.1); text-shadow: none; }
    
        /* --- UI Buttons --- */
        .ui-button { position: fixed; z-index: 1001; background: rgba(255, 0, 0, 0.3); border: 2px solid var(--blood-red); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: inherit; backdrop-filter: blur(5px); transition: all 0.3s; opacity: 0; pointer-events: none; }
        .ui-button.visible { opacity: 1; pointer-events: auto; }
        .ui-button:hover { transform: scale(1.1); box-shadow: 0 0 15px var(--blood-red); }
        .ui-button svg { width: 24px; height: 24px; fill: var(--blood-red); }
        #audio-toggle-btn { bottom: 20px; left: 20px; }
        .whatsapp-float { bottom: 20px; right: 20px; background: #25D366; border-color: #25D366; }
        .whatsapp-float:hover { background: #25D366; box-shadow: 0 0 20px #25D366; }
        .whatsapp-float svg { fill: white; width: 30px; height: 30px; }
    </style>
</head>
<body class="selection:bg-blood-red selection:text-white">
    
    <div class="scroll-watcher"></div>
    <video autoplay muted loop id="video-bg">
      <source src="https://videos.pexels.com/video-files/3130367/3130367-hd.mp4" type="video/mp4">
    </video>
    <div class="vhs-overlay"></div>
    <div id="lightning"></div>

    <audio id="background-music" loop>
        <source src="https://files.catbox.moe/m2odq2.mp3" type="audio/mpeg">
    </audio>

    <div id="modal-sequence">
        <div class="modal-step active" data-step="1">
            <h2 class="modal-text">Ten cuidado... una fiesta legendaria te espera.</h2>
            <button class="modal-button" data-next="2">Continuar...</button>
        </div>
        <div class="modal-step" data-step="2">
            <h2 class="modal-text">Tu alma es el precio de la entrada.</h2>
            <button class="modal-button" data-next="3">Acepto el riesgo...</button>
        </div>
        <div class="modal-step" data-step="3">
            <h2 class="modal-text">¿Listo para desatar el caos?</h2>
            <button class="modal-button" id="enter-site-btn">ENTRAR AL ABISMO</button>
        </div>
    </div>
    
    <div id="countdown-ended-overlay">
        <h2 class="end-message">¡EL INFIERNO HA COMENZADO!</h2>
    </div>

    <button id="audio-toggle-btn" class="ui-button" aria-label="Activar/desactivar música">
        <svg id="sound-on-icon" style="display: none;" viewBox="0 0 24 24"><path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"/></svg>
        <svg id="sound-off-icon" viewBox="0 0 24 24"><path d="M12,4L7,9H3V15H7L12,20V4M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,12.28 18.98,12.55 18.94,12.82L19.71,13.59C20.42,12.83 20.94,11.91 21,10.91V10.9C21,7.72 18,4.14 14,3.23M16.5,12C16.5,11.39 16.41,10.81 16.25,10.26L14,7.97V16C15.06,15.54 15.82,14.65 16.2,13.59C16.4,13.08 16.5,12.55 16.5,12M1.39,4.22L3,5.83V9H4.76L8.95,13.18L10.05,14.28L12,16.23V20L13.18,18.82L19.78,25.41L21.19,24L1.39,4.22Z"/></svg>
    </button>
    <a href="https://wa.me/59178107853?text=Hola%20Julio%21%20Quiero%20comprar%20mi%20manilla%20para%20el%20Junte%20de%20Ex%20Promociones%202005%20SEAPF%20del%20Colegio%20Andres%20Ibañez.%20Espero%20tu%20respuesta.%20%F0%9F%91%BB" target="_blank" class="ui-button whatsapp-float" aria-label="Contactar por WhatsApp">
        <svg viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99 0-3.903-.52-5.586-1.459L.057 24zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.655 4.398 1.908 6.161l-1.334 4.869 4.869-1.332z"/></svg>
    </a>
    
    <main class="relative z-10 opacity-0 transition-opacity duration-1000">
        <!-- Header Section -->
        <header class="text-center py-20 px-4 min-h-screen flex flex-col justify-center items-center">
            <div class="max-w-5xl mx-auto relative">
                <h2 class="text-[clamp(1.5rem,4vw,2.5rem)] text-white font-bold mb-4 ghost-reveal-text">
                    LA CUENTA REGRESIVA PARA EL CAOS HA COMENZADO
                </h2>
                <div id="countdown-container" class="flex justify-center items-start space-x-2 sm:space-x-4 my-12">
                     <!-- El contador se genera aquí con JS -->
                </div>
                <!-- CAMBIO: Se reestructura el H1 para el nuevo título multinívea y se usa nueva fuente 'Butcherman' -->
                <h1 class="text-center mt-8 mb-6 opacity-0" style="animation: epic-title-intro 1.5s ease-out 0.5s forwards;">
                    <span class="butcherman block text-[clamp(3rem,14vw,10rem)] leading-none">EL GRAN</span>
                    <span class="butcherman block text-[clamp(4rem,20vw,14rem)] leading-none">JUNTE</span>
                    <span class="nosifier block text-[clamp(1.5rem,7vw,4rem)] leading-tight text-toxic-green mt-2">EX-PROMOCIONES</span>
                    <span class="metal-mania block text-[clamp(1.2rem,5vw,2.5rem)] leading-tight text-white tracking-widest mt-1">COL. ANDRES IBAÑEZ</span>
                    <!-- CAMBIO: Se añadió la clase 'highlight-version' para la animación -->
                    <span class="metal-mania block text-[clamp(1.2rem,5vw,2.5rem)] leading-tight text-white tracking-widest highlight-version">Version 2025</span>
                </h1>
                <p class="metal-mania text-2xl mb-12 ghost-reveal-text max-w-4xl mx-auto px-4">La <span class="text-toxic-green">Promo 2005 "SEAPF"</span> te condena a una noche de recuerdos y desenfreno.</p>
                <a href="#manillas" class="cta-button inline-block px-10 py-4 text-xl sm:text-2xl rounded-lg uppercase">¡RECLAMA TU MANILLA!</a>
            </div>
        </header>

        <section class="py-20 px-4 bg-black/80 backdrop-blur-sm">
            <div class="max-w-6xl mx-auto text-center">
                <h3 class="creepster text-[clamp(2.5rem,7vw,4.5rem)] text-toxic-green mb-12 ghost-reveal-text">RITUALES DE LA NOCHE</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    <div class="border border-demonic-purple p-6 bg-black/70 rounded-lg transition-all duration-300 ease-in-out hover:scale-105 hover:shadow-2xl hover:shadow-demonic-purple/50">
                        <h4 class="creepster text-3xl text-demonic-purple mb-2">INFIERNO DE DISFRACES</h4>
                        <p class="metal-mania text-lg">El atuendo más aterrador se llevará la gloria y un premio maldito.</p>
                    </div>
                    <div class="border border-demonic-purple p-6 bg-black/70 rounded-lg transition-all duration-300 ease-in-out hover:scale-105 hover:shadow-2xl hover:shadow-demonic-purple/50">
                        <h4 class="creepster text-3xl text-demonic-purple mb-2">SANGRE Y ARENA</h4>
                        <p class="metal-mania text-lg">Nuestra barra de pócimas te mantendrá en pie toda la noche. ¡Salud, pecador!</p>
                    </div>
                    <div class="border border-demonic-purple p-6 bg-black/70 rounded-lg transition-all duration-300 ease-in-out hover:scale-105 hover:shadow-2xl hover:shadow-demonic-purple/50">
                        <h4 class="creepster text-3xl text-demonic-purple mb-2">ECOS DEL PASADO</h4>
                        <p class="metal-mania text-lg">El DJ invocará los himnos que te hicieron vibrar. Baila hasta que tus pecados sean perdonados.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ELIMINADO: La sección "Galería de Horrores" fue removida. -->

        <section id="manillas" class="py-20 px-4 bg-black/80 backdrop-blur-sm">
            <div class="max-w-4xl mx-auto text-center">
                 <h3 class="creepster text-[clamp(2.5rem,7vw,4.5rem)] text-red-500 mb-4 ghost-reveal-text">EL PORTAL</h3>
                <p class="metal-mania text-xl mb-8 px-4">El ritual se llevará a cabo en un lugar donde los gritos no se escuchan.</p>
                <div class="border-4 border-toxic-green p-6 sm:p-10 rounded-xl mx-auto bg-black/80 shadow-2xl shadow-toxic-green/30">
                    <p class="text-xl font-bold text-toxic-green">Fecha y Hora Fatal:</p>
                    <p class="text-3xl md:text-4xl text-white font-black mb-6">Sábado 11/10/2025 - 21:00 HRS</p>
                    <p class="text-xl font-bold text-toxic-green">Ubicación Secreta:</p>
                    <p class="text-3xl md:text-4xl text-white font-black mb-8">Salón de Eventos San José (Plan 3000)</p>
                    <p class="text-xl md:text-2xl text-red-500 font-bold mb-6">No hay escapatoria. Consigue tu manilla.</p>
                    <a href="https://wa.me/59178107853?text=Hola%20Julio%21%20Quiero%20comprar%20mi%20manilla%20para%20el%20Junte%20de%20Ex%20Promociones%202005%20SEAPF%20del%20Colegio%20Andres%20Ibañez.%20Espero%20tu%20respuesta.%20%F0%9F%91%BB" target="_blank" class="cta-button inline-block px-8 py-3 text-lg sm:text-xl rounded-lg uppercase">Contactar al Guardián</a>
                </div>
            </div>
        </section>

        <footer class="py-8 px-4 text-center border-t-2 border-t-blood-red/30">
            <p class="text-lg font-bold text-toxic-green">Invoca: Promo 2005 SEAPF</p>
        </footer>
    </main>
    
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const audio = document.getElementById('background-music');
        const modalSequence = document.getElementById('modal-sequence');
        const mainContent = document.querySelector('main');
        const audioToggleBtn = document.getElementById('audio-toggle-btn');
        const soundOnIcon = document.getElementById('sound-on-icon');
        const soundOffIcon = document.getElementById('sound-off-icon');
        const whatsappBtn = document.querySelector('.whatsapp-float');
        const lightning = document.getElementById('lightning');
        
        // --- Modal Logic ---
        document.getElementById('enter-site-btn').addEventListener('click', () => {
            audio.play().catch(error => {});
            soundOnIcon.style.display = 'block';
            soundOffIcon.style.display = 'none';
            modalSequence.style.transition = 'opacity 1s';
            modalSequence.style.opacity = '0';
            setTimeout(() => modalSequence.style.display = 'none', 1000);
            mainContent.style.opacity = '1';
            audioToggleBtn.classList.add('visible');
            whatsappBtn.classList.add('visible');
            
            document.querySelectorAll('.ghost-reveal-text').forEach(el => {
                const text = el.textContent.trim(); // Trim to handle whitespace
                el.innerHTML = '';
                // Need to handle child nodes for the complex H1
                const childNodes = Array.from(el.childNodes);
                if (childNodes.length > 1) {
                    childNodes.forEach(node => {
                        if (node.nodeType === 3) { // Text node
                             node.textContent.split('').forEach((char, index) => {
                                const span = document.createElement('span');
                                span.textContent = char === ' ' ? '\u00A0' : char;
                                span.style.animationDelay = `${(el.querySelectorAll('span').length + index) * 0.03}s`;
                                el.appendChild(span);
                            });
                        } else { // Element node like <span>
                            el.appendChild(node.cloneNode(true));
                        }
                    });
                } else {
                     text.split('').forEach((char, index) => {
                        const span = document.createElement('span');
                        span.textContent = char === ' ' ? '\u00A0' : char;
                        span.style.animationDelay = `${index * 0.03}s`;
                        el.appendChild(span);
                    });
                }
            });
            setInterval(triggerLightning, Math.random() * 15000 + 8000);
        });
        
        modalSequence.addEventListener('click', e => {
            if (e.target.matches('.modal-button[data-next]')) {
                const currentStepEl = e.target.closest('.modal-step');
                const nextStep = e.target.dataset.next;
                currentStepEl.classList.remove('active');
                document.querySelector(`.modal-step[data-step="${nextStep}"]`).classList.add('active');
            }
        });

        // --- Audio Toggle Logic ---
        audioToggleBtn.addEventListener('click', () => {
            audio.muted = !audio.muted;
            soundOnIcon.style.display = audio.muted ? 'none' : 'block';
            soundOffIcon.style.display = audio.muted ? 'block' : 'none';
        });

        function triggerLightning() {
            lightning.style.animation = 'lightning-flash 0.5s ease-out';
            setTimeout(() => lightning.style.animation = 'none', 500);
        }

        // --- Professional Countdown Timer ---
        const targetDate = new Date('October 11, 2025 21:00:00').getTime();
        const countdownContainer = document.getElementById('countdown-container');
        let previousTime = {};

        function createFlipCard(label) {
            const timeBlock = document.createElement('div');
            timeBlock.className = 'time-block';
            timeBlock.innerHTML = `
                <div class="flip-card" id="flip-card-${label.toLowerCase()}">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">00</div>
                        <div class="flip-card-back">00</div>
                    </div>
                </div>
                <div class="time-label">${label}</div>
            `;
            return timeBlock;
        }

        function createSeparator() {
            const separator = document.createElement('div');
            separator.className = 'separator self-center';
            separator.textContent = ':';
            return separator;
        }

        ['DÍAS', 'HRS', 'MIN', 'SEG'].forEach((label, i) => {
            countdownContainer.appendChild(createFlipCard(label));
            if (i < 3) countdownContainer.appendChild(createSeparator());
        });

        function updateFlipCard(label, value) {
            const card = document.getElementById(`flip-card-${label.toLowerCase()}`);
            if (!card) return;
            const inner = card.querySelector('.flip-card-inner');
            const front = card.querySelector('.flip-card-front');
            const back = card.querySelector('.flip-card-back');
            const formattedValue = String(value).padStart(2, '0');
            
            if (previousTime[label] !== formattedValue) {
                if(inner.style.transform === 'rotateX(-180deg)') {
                   // Avoid re-triggering animation if it's already in progress
                } else {
                    front.textContent = formattedValue;
                    back.textContent = previousTime[label] || formattedValue;
                    inner.style.transform = 'rotateX(-180deg)';
                    setTimeout(() => {
                        back.textContent = formattedValue;
                        inner.style.transition = 'none';
                        inner.style.transform = 'rotateX(0deg)';
                        setTimeout(() => {
                            inner.style.transition = 'transform 0.6s';
                        }, 50);
                    }, 600);
                }
                previousTime[label] = formattedValue;
            }
        }

        function updateCountdown() {
            const now = new Date().getTime();
            const dist = targetDate - now;

            if (dist < 0) {
                clearInterval(countdownInterval);
                document.getElementById('countdown-ended-overlay').classList.add('active');
                triggerLightning();
                return;
            }

            const d = Math.floor(dist / 86400000);
            const h = Math.floor((dist % 86400000) / 3600000);
            const m = Math.floor((dist % 3600000) / 60000);
            const s = Math.floor((dist % 60000) / 1000);
            
            updateFlipCard('días', d);
            updateFlipCard('hrs', h);
            updateFlipCard('min', m);
            updateFlipCard('seg', s);
        }
        
        const countdownInterval = setInterval(updateCountdown, 1000);
        updateCountdown();
    });
    </script>
</body>
</html>
